/**********************************************************
 * Copyright (C) 2017 All rights reserved.
 * \file cache_handle.cpp
 * \brief
 * \note	注意事项：
 *
 *\version 1.0
 ** \author Allen.L
 ** \date 2017-08-04
 ** \last modified 2017-08-07 17:04:09
**********************************************************/

#include "cache_handle.h"

namespace base {
namespace cache {


Connection::Connection(const std::string &host, const uint32 port, uint32 timeout) {
	struct timeval tv;
	tv.tv_sec = timeout / 1000;
	tv.tv_usec = (timeout % 1000) * 1000;

	context_ = redisConnectWithTimeout(host.c_str(), port, tv);
	if (context_->err != REDIS_OK) {
		logger_->warning("cachedb connection fail![host=%s, port=%d, error=%s]", host.c_str(), (int) port, context->errstr);
		redisFree(context);
		context = NULL;
	}
}


} //cache
} //base
